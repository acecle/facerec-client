(this["webpackJsonpfacerec-client"]=this["webpackJsonpfacerec-client"]||[]).push([[0],{117:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(8),c=a.n(i),o=(a(83),a(16)),l=a(75),s=a(70),d=(a(84),a(5)),u=a(141),m=a(145),p=a(146),h=a(147),g=a(73),v=a.n(g),f=a(151),E=a(144),b=a(74),y=a.n(b),w=a(48),T=a(148),x=a(152),O=a(149),D=a(150),j=a(47),k=a.n(j),R=a(38),S=a(26),I=a(119),W=a(46),F=a.n(W),N=a(24),U=a(17),C=a(30),B=a(31),P=a(35),H=a(29),L=a(32),A=a.n(L),M=function(e){function t(e){var a;Object(N.a)(this,t),(a=Object(C.a)(this,Object(B.a)(t).call(this,e))).intervalID=0,a.videoWidth=400,a.videoHeight=400,a.videoTag=r.a.createRef(),a.textRef=r.a.createRef(),a.imageTag=r.a.createRef(),a.faceTextRef=r.a.createRef();return Promise.all([H.e.tinyFaceDetector.loadFromUri("/facerec-client/models")]).then(a.printLoaded()),a}return Object(P.a)(t,e),Object(U.a)(t,[{key:"printLoaded",value:function(){}},{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(navigator.mediaDevices.getUserMedia({video:{width:this.videoWidth,height:this.videoHeight,frameRate:{max:30},facingMode:"user"},audio:!1}).then((function(t){return e.videoTag.current.srcObject=t})).catch((function(e){console.error(e)})),this.videoTag.current.width=this.videoWidth,this.videoTag.current.height=this.videoHeight,this.videoTag.current.addEventListener("play",this)):alert("Camera not supported in your browser!")}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalID)}},{key:"handleEvent",value:function(e){var t=this,a={width:this.videoTag.current.width,height:this.videoTag.current.height};this.intervalID=setInterval((function(){var e,n,r,i,c,o;return F.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,F.a.awrap(H.c(t.videoTag.current,new H.b));case 2:e=l.sent;try{t.textRef.current.innerText="Found: "+e.length}catch(s){}if(!(e.length>0)){l.next=14;break}return n=H.f(e,a),r=n[0]._box,i=[new H.a(r.left-50,r.top-50,r.width+100,r.height+100)],l.next=10,F.a.awrap(H.d(t.videoTag.current,i));case 10:c=l.sent,o=c[0].toDataURL(),t.imageTag.current.src=o,t.sendImageToServer(o);case 14:case"end":return l.stop()}}))}),500)}},{key:"sendImageToServer",value:function(e){var t=this,a=this.dataURItoBlob(e),n=new File([a],"image.png"),r=new FormData,i=(new Date).toLocaleString()+".png";r.append("file",n,i),A()({method:"post",url:"https://acecle-facerec-test-server.herokuapp.com/",data:r,headers:{"Content-Type":File}}).then((function(e){t.code==e.data?t.faceTextRef.current.innerText="Found "+e.data+", Face Recognised!":t.faceTextRef.current.innerText="Found "+e.data+", Face Incorrectly Recognised"})).catch((function(e){console.log(e)}))}},{key:"dataURItoBlob",value:function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var a=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([n],{type:a})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("video",{ref:this.videoTag,autoPlay:!0,playsInline:!0}),r.a.createElement("p",{ref:this.textRef},"Found: 0"),r.a.createElement("img",{ref:this.imageTag,alt:"face",hidden:!0}),r.a.createElement("p",{ref:this.faceTextRef},"Unknown Face"))}}]),t}(n.Component);function J(){var e=Object(u.a)((function(e){return{holder:{display:"flex",flexWrap:"wrap"},paperTest:{padding:e.spacing(2.5,2.5,2.5,2.5),margin:e.spacing(0,2,2,0),overflow:"auto",minWidth:"20%",float:"left"},topDivider:{margin:e.spacing(1,0,2,0)}}}))();return r.a.createElement("div",{className:"holder"},r.a.createElement(I.a,{className:e.paperTest},r.a.createElement(w.a,{variant:"h5",noWrap:!0},"Live Face Detection"),r.a.createElement(E.a,{className:e.topDivider}),r.a.createElement(M,null)))}var $=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(C.a)(this,Object(B.a)(t).call(this,e))).videoWidth=400,a.videoHeight=400,a.currentImage=null,a.submit=function(e){e.preventDefault();var t=a.textTag.value;null!==a.currentImage&&!1===a.state.isPlaying&&(a.setState({isDisabled:!0}),a.sendImageToServer(a.currentImage,t))},a.picture=function(e){if(a.state.isPlaying){a.videoTag.current.pause(),a.setState({isPlaying:!1});var t=document.createElement("canvas");t.width=a.videoWidth,t.height=a.videoHeight,t.getContext("2d").drawImage(a.videoTag.current,0,0,t.width,t.height);var n=t.toDataURL("image/png");a.currentImage=n}else a.videoTag.current.play(),a.setState({isPlaying:!0})},a.videoTag=r.a.createRef(),a.textTag=r.a.createRef(),a.outputTag=r.a.createRef(),a.state={isPlaying:!0,isDisabled:!1},a}return Object(P.a)(t,e),Object(U.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(navigator.mediaDevices.getUserMedia({video:{width:this.videoWidth,height:this.videoHeight,frameRate:{max:30},facingMode:"user"},audio:!1}).then((function(t){return e.videoTag.current.srcObject=t})).catch((function(e){console.error(e)})),this.videoTag.current.width=this.videoWidth,this.videoTag.current.height=this.videoHeight):alert("Camera not supported in your browser!")}},{key:"sendImageToServer",value:function(e,t){var a=this,n=this.dataURItoBlob(e),r=new File([n],"image.png"),i=new FormData;i.append("file",r,t),A()({method:"post",url:"https://acecle-facerec-test-server.herokuapp.com/upload",data:i,headers:{"Content-Type":File}}).then((function(e){console.log(e.data),a.setState({isDisabled:!1}),"False"!==e.data?a.outputTag.current.innerText="Success! Added user: "+e.data:a.outputTag.current.innerText="Failed to add user to the system, please try again!"})).catch((function(e){console.log(e)}))}},{key:"dataURItoBlob",value:function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var a=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([n],{type:a})}},{key:"render",value:function(){var e=this,t=this.state.isPlaying,a=this.state.isDisabled;return r.a.createElement("div",null,r.a.createElement("video",{ref:this.videoTag,autoPlay:!0,playsInline:!0}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.picture},t?"Take Picture":"Take Again"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("input",{type:"text",ref:function(t){return e.textTag=t}}),r.a.createElement("button",{onClick:this.submit,disabled:a?"disabled":""},"Submit"),r.a.createElement("p",{ref:this.outputTag}))}}]),t}(n.Component);function G(){var e=Object(u.a)((function(e){return{holder:{display:"flex",flexWrap:"wrap"},paperTest:{padding:e.spacing(2.5,2.5,2.5,2.5),margin:e.spacing(0,2,2,0),overflow:"auto",minWidth:"20%",float:"left"},topDivider:{margin:e.spacing(1,0,2,0)}}}))();return r.a.createElement("div",{className:"holder"},r.a.createElement(I.a,{className:e.paperTest},r.a.createElement(w.a,{variant:"h5",noWrap:!0},"Add User"),r.a.createElement(E.a,{className:e.topDivider}),r.a.createElement($,null)))}var _=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(C.a)(this,Object(B.a)(t).call(this,e))).state={data:[]},a}return Object(P.a)(t,e),Object(U.a)(t,[{key:"componentDidMount",value:function(){var e=this;return A()({method:"get",url:"https://acecle-facerec-test-server.herokuapp.com/recognitions"}).then((function(t){console.log(t.data),e.setState({data:t.data})})).catch((function(e){})),null}},{key:"render",value:function(){var e={textAlign:"center",padding:"10px 0"};return r.a.createElement("div",null,r.a.createElement("table",{style:{borderCollapse:"seperate",borderSpacing:"10px 0"}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Expected"),r.a.createElement("th",null,"Time"),r.a.createElement("th",null,"Room"))),r.a.createElement("tbody",null,this.state.data.map((function(t,a){return r.a.createElement("tr",{key:a},r.a.createElement("td",{style:e},t.name),r.a.createElement("td",{style:e},t.expected),r.a.createElement("td",{style:e},new Date(t.time.$date).toUTCString()),r.a.createElement("td",{style:e},t.room))})))))}}]),t}(n.Component);function q(){var e=Object(u.a)((function(e){return{holder:{display:"flex",flexWrap:"wrap"},paperTest:{padding:e.spacing(2.5,2.5,2.5,2.5),margin:e.spacing(0,2,2,0),overflow:"auto",minWidth:"20%",float:"left"},topDivider:{margin:e.spacing(1,0,2,0)}}}))();return r.a.createElement("div",{className:"holder"},r.a.createElement(I.a,{className:e.paperTest},r.a.createElement(w.a,{variant:"h5",noWrap:!0},"Recognition Page"),r.a.createElement(E.a,{className:e.topDivider}),r.a.createElement(_,{className:e})))}var z=Object(u.a)((function(e){return{root:{display:"flex"},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(300,"px)"),marginLeft:300,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},drawer:{width:300,flexShrink:0},drawerPaper:{width:300},drawerHeader:Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:0},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:300}}}));var K=function(){var e=z(),t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1];return r.a.createElement("div",{className:"root"},r.a.createElement(R.a,{basename:"/facerec-client"},r.a.createElement(m.a,{position:"fixed",className:Object(d.a)(e.appBar,Object(o.a)({},e.appBarShift,n))},r.a.createElement(p.a,null,r.a.createElement(h.a,{edge:"start",className:Object(d.a)(e.menuButton,n&&e.hide),onClick:function(){i(!0)},color:"inherit","aria-label":"menu"},r.a.createElement(v.a,null)),r.a.createElement(w.a,{id:"pageTitle",variant:"h6",noWrap:!0},"Project"))),r.a.createElement(f.a,{className:e.drawer,variant:"persistent",anchor:"left",open:n,classes:{paper:e.drawerPaper}},r.a.createElement("div",{className:e.drawerHeader},r.a.createElement(h.a,{onClick:function(){i(!1)}},r.a.createElement(y.a,null))),r.a.createElement(E.a,null),r.a.createElement(T.a,null,r.a.createElement(x.a,{button:!0,component:R.b,to:"/"},r.a.createElement(O.a,null,r.a.createElement(k.a,null)),r.a.createElement(D.a,{primary:"Add User"})),r.a.createElement(x.a,{button:!0,component:R.b,to:"/page2"},r.a.createElement(O.a,null,r.a.createElement(k.a,null)),r.a.createElement(D.a,{primary:"Face Recognition"})),r.a.createElement(x.a,{button:!0,component:R.b,to:"/page3"},r.a.createElement(O.a,null,r.a.createElement(k.a,null)),r.a.createElement(D.a,{primary:"Recognitions"})))),r.a.createElement("main",{className:Object(d.a)(e.content,Object(o.a)({},e.contentShift,n))},r.a.createElement("div",{className:e.drawerHeader}),r.a.createElement("div",null," ",r.a.createElement(S.c,null,r.a.createElement(S.a,{exact:!0,path:"/"},r.a.createElement(G,null)),r.a.createElement(S.a,{path:"/page2"},r.a.createElement(J,null)),r.a.createElement(S.a,{path:"/page3"},r.a.createElement(q,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},78:function(e,t,a){e.exports=a(117)},83:function(e,t,a){},84:function(e,t,a){},92:function(e,t){},93:function(e,t){},94:function(e,t){}},[[78,1,2]]]);
//# sourceMappingURL=main.b25ed24b.chunk.js.map